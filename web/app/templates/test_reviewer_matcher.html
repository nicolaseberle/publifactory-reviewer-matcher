<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>Reviewer Matcher - {{titre}}</title>

  <link href="{{ url_for('static', filename='normalize.css') }}" rel="stylesheet" type="text/css" />
  <link href="{{ url_for('static', filename='main.css') }}" rel="stylesheet" type="text/css" />



  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script>
    var source = new EventSource("/test_reviewer_matcher");
    source.onmessage = function(event) {
      $('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);
      $('.progress-bar-label').text(event.data+'%');
      if(event.data == 100){
        source.close()
      }
    }
  </script>

  
</head>
<body>

<h1>{{titre}}</h1>
  
{% from "_formhelpers.html" import render_field %}
<form method=post>
    <dl>
      {{ render_field(form.abstract) }}
    </dl>
    <p>{{ render_field(form.submit) }}
</form>

<div class="progress" style="width: 50%; margin: 50px;">
  <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
    <span class="progress-bar-label">0%</span>
  </div>
</div>


{% if (data) != -1 %}
<ul>
{% for sent in data %}
<li>
  <ul>
    <li>({{sent["verification"]}}) {{sent["name"]}} ({{sent["id"]}})</li>
    <li>Score: {{sent["score"]}}</li>
    <li>Score with year: {{sent["scorePond"]}}</li>
    <li>Affiliation: {{sent["affiliation"]}}</li>
    <li>Conflit d'intérêt: {{sent["conflit"]}}</li> 
    <li>Articles :
      <ul>
	{% for art in sent["article"] %}
	<li>{{art}}</li>
	{% endfor %}
      </ul>
    </li>
    <li>Abstract :
      <ul>
	{% for abs in sent["abstract"] %}
	<li>{{abs}}</li>
	{% endfor %}
      </ul>
          </li>
    <li>Contacts :
      <ul>
	{% for con in sent["contact"] %}
	{% for key, value in con.items() %}
	<li><a href={{value}}>{{key}}</a></li>
	{% endfor %}
	{% endfor %}
      </ul>
    </li>
  </ul>
<li>
{% endfor %}
</ul>
{% endif %}

</body>
</html>
